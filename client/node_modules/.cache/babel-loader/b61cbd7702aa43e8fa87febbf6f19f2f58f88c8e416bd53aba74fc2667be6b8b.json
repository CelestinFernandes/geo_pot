{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\CELESTIN\\\\Desktop\\\\geotr\\\\geo_pot\\\\client\\\\src\\\\components\\\\MapComponent.jsx\",\n  _s2 = $RefreshSig$();\nimport { useState, useCallback, useRef, forwardRef } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, useMapEvents } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport SearchLocation from \"./SearchLocation\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: \"/images/marker-icon-2x.png\",\n  iconUrl: \"/images/marker-icon.png\",\n  shadowUrl: \"/images/marker-shadow.png\"\n});\nconst createIcon = emoji => L.divIcon({\n  className: \"custom-icon\",\n  html: `<div style=\"font-size: 32px;\">${emoji}</div>`,\n  iconSize: [32, 32],\n  iconAnchor: [16, 16]\n});\nconst icons = {\n  crack: createIcon(\"🚧\"),\n  pothole: createIcon(\"⚠️\"),\n  photo: createIcon(\"📷\"),\n  search: createIcon(\"📍\")\n};\nconst MapComponent = /*#__PURE__*/_s2(/*#__PURE__*/forwardRef(_c = _s2(({\n  capturedPhotos = [],\n  onDeletePhoto\n}, ref) => {\n  var _s = $RefreshSig$();\n  _s2();\n  const [markers, setMarkers] = useState([]);\n  const [selectedType, setSelectedType] = useState(\"crack\");\n  const mapRef = useRef();\n  useImperativeHandle(ref, () => ({\n    flyToLocation: location => {\n      var _mapRef$current;\n      return (_mapRef$current = mapRef.current) === null || _mapRef$current === void 0 ? void 0 : _mapRef$current.setView(location, 16);\n    }\n  }));\n  const handleSearch = (coords, name) => {\n    var _mapRef$current2;\n    (_mapRef$current2 = mapRef.current) === null || _mapRef$current2 === void 0 ? void 0 : _mapRef$current2.setView(coords, 16);\n    L.marker(coords, {\n      icon: icons.search\n    }).addTo(mapRef.current).bindPopup(`<b>Search Result:</b><br>${name}`).openPopup().on(\"popupclose\", e => e.target.remove());\n  };\n  const MapClickHandler = () => {\n    _s();\n    return useMapEvents({\n      click: e => !e.originalEvent.propagatedFromMarker && setMarkers(prev => [...prev, {\n        position: [e.latlng.lat, e.latlng.lng],\n        type: selectedType,\n        id: Date.now()\n      }])\n    });\n  };\n  _s(MapClickHandler, \"Ld/tk8Iz8AdZhC1l7acENaOEoCo=\", false, function () {\n    return [useMapEvents];\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-container\",\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [19.125, 72.9],\n      zoom: 13,\n      ref: mapRef,\n      style: {\n        height: \"100%\",\n        width: \"100%\"\n      },\n      tap: false,\n      zoomControl: window.innerWidth > 768,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapClickHandler, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), [...markers, ...capturedPhotos.map(p => ({\n        id: p.id,\n        type: 'photo',\n        position: p.location\n      }))].map(({\n        id,\n        position,\n        type\n      }) => /*#__PURE__*/_jsxDEV(Marker, {\n        position: position,\n        icon: icons[type],\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: type.charAt(0).toUpperCase() + type.slice(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setMarkers(prev => prev.filter(m => m.id !== id));\n              onDeletePhoto(id);\n            },\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this)\n      }, id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-controls\",\n      children: [/*#__PURE__*/_jsxDEV(SearchLocation, {\n        onSearch: handleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedType,\n        onChange: e => setSelectedType(e.target.value),\n        children: [\"crack\", \"pothole\"].map(o => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: o,\n          children: [icons[o].options.html, \" \", o]\n        }, o, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setMarkers(prev => prev.slice(0, -1)),\n        children: \"\\uD83D\\uDDD1\\uFE0F Delete Last\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setMarkers([]),\n        children: \"\\uD83E\\uDDF9 Clear All\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}, \"kgMaPhSVp//6CG4+f1s30Ehrs8o=\")), \"kgMaPhSVp//6CG4+f1s30Ehrs8o=\");\n_c2 = MapComponent;\nexport default MapComponent;\nvar _c, _c2;\n$RefreshReg$(_c, \"MapComponent$forwardRef\");\n$RefreshReg$(_c2, \"MapComponent\");","map":{"version":3,"names":["_jsxFileName","_s2","$RefreshSig$","useState","useCallback","useRef","forwardRef","MapContainer","TileLayer","Marker","Popup","useMapEvents","L","SearchLocation","jsxDEV","_jsxDEV","Icon","Default","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","createIcon","emoji","divIcon","className","html","iconSize","iconAnchor","icons","crack","pothole","photo","search","MapComponent","_c","capturedPhotos","onDeletePhoto","ref","_s","markers","setMarkers","selectedType","setSelectedType","mapRef","useImperativeHandle","flyToLocation","location","_mapRef$current","current","setView","handleSearch","coords","name","_mapRef$current2","marker","icon","addTo","bindPopup","openPopup","on","e","target","remove","MapClickHandler","click","originalEvent","propagatedFromMarker","prev","position","latlng","lat","lng","type","id","Date","now","children","center","zoom","style","height","width","tap","zoomControl","window","innerWidth","url","fileName","lineNumber","columnNumber","map","p","charAt","toUpperCase","slice","onClick","filter","m","onSearch","value","onChange","o","options","_c2","$RefreshReg$"],"sources":["C:/Users/CELESTIN/Desktop/geotr/geo_pot/client/src/components/MapComponent.jsx"],"sourcesContent":["\"use client\"\r\nimport { useState, useCallback, useRef, forwardRef } from \"react\"\r\nimport { MapContainer, TileLayer, Marker, Popup, useMapEvents } from \"react-leaflet\"\r\nimport L from \"leaflet\"\r\nimport \"leaflet/dist/leaflet.css\"\r\nimport SearchLocation from \"./SearchLocation\"\r\n\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: \"/images/marker-icon-2x.png\",\r\n  iconUrl: \"/images/marker-icon.png\",\r\n  shadowUrl: \"/images/marker-shadow.png\",\r\n})\r\n\r\nconst createIcon = (emoji) => L.divIcon({\r\n  className: \"custom-icon\",\r\n  html: `<div style=\"font-size: 32px;\">${emoji}</div>`,\r\n  iconSize: [32, 32],\r\n  iconAnchor: [16, 16],\r\n})\r\n\r\nconst icons = {\r\n  crack: createIcon(\"🚧\"), pothole: createIcon(\"⚠️\"), \r\n  photo: createIcon(\"📷\"), search: createIcon(\"📍\")\r\n}\r\n\r\nconst MapComponent = forwardRef(({ capturedPhotos = [], onDeletePhoto }, ref) => {\r\n  const [markers, setMarkers] = useState([])\r\n  const [selectedType, setSelectedType] = useState(\"crack\")\r\n  const mapRef = useRef()\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    flyToLocation: (location) => mapRef.current?.setView(location, 16)\r\n  }))\r\n\r\n  const handleSearch = (coords, name) => {\r\n    mapRef.current?.setView(coords, 16)\r\n    L.marker(coords, { icon: icons.search })\r\n      .addTo(mapRef.current)\r\n      .bindPopup(`<b>Search Result:</b><br>${name}`)\r\n      .openPopup().on(\"popupclose\", (e) => e.target.remove())\r\n  }\r\n\r\n  const MapClickHandler = () => useMapEvents({\r\n    click: (e) => !e.originalEvent.propagatedFromMarker && \r\n      setMarkers(prev => [...prev, {\r\n        position: [e.latlng.lat, e.latlng.lng],\r\n        type: selectedType,\r\n        id: Date.now()\r\n      }])\r\n  })\r\n\r\n  return (\r\n    <div className=\"map-container\">\r\n      <MapContainer center={[19.125, 72.9]} zoom={13} ref={mapRef}\r\n        style={{ height: \"100%\", width: \"100%\" }} tap={false}\r\n        zoomControl={window.innerWidth > 768}>\r\n        \r\n        <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n        <MapClickHandler />\r\n\r\n        {[...markers, ...capturedPhotos.map(p => ({\r\n          id: p.id, type: 'photo', position: p.location\r\n        }))].map(({ id, position, type }) => (\r\n          <Marker key={id} position={position} icon={icons[type]}>\r\n            <Popup>\r\n              <b>{type.charAt(0).toUpperCase() + type.slice(1)}</b>\r\n              <button onClick={() => {\r\n                setMarkers(prev => prev.filter(m => m.id !== id))\r\n                onDeletePhoto(id)\r\n              }}>Delete</button>\r\n            </Popup>\r\n          </Marker>\r\n        ))}\r\n      </MapContainer>\r\n\r\n      <div className=\"map-controls\">\r\n        <SearchLocation onSearch={handleSearch} />\r\n        <select value={selectedType} onChange={e => setSelectedType(e.target.value)}>\r\n          {[\"crack\", \"pothole\"].map(o => \r\n            <option key={o} value={o}>{icons[o].options.html} {o}</option>\r\n          )}\r\n        </select>\r\n        <button onClick={() => setMarkers(prev => prev.slice(0, -1))}>🗑️ Delete Last</button>\r\n        <button onClick={() => setMarkers([])}>🧹 Clear All</button>\r\n      </div>\r\n    </div>\r\n  )\r\n})\r\n\r\nexport default MapComponent"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}